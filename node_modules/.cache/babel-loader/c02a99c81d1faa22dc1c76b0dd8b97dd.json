{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\m_obr\\\\OneDrive\\\\Documents\\\\GitHub\\\\TEST\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";/*\r\n *   Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\r\n *  You may not use this file except in compliance with the License.\r\n *  A copy of the License is located at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  or in the \"license\" file accompanying this file. This file is distributed\r\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\r\n *  express or implied. See the License for the specific language governing\r\n *  permissions and limitations under the License.\r\n */import React from'react';import{Auth}from'aws-amplify';import DynamicImage from'../components/DynamicImage';import{withRouter}from'react-router-dom';import'../css/app.css';/**\r\n * Registration Page\r\n */var SignUp=/*#__PURE__*/function(_React$Component){_inherits(SignUp,_React$Component);var _super=_createSuper(SignUp);function SignUp(props){var _this;_classCallCheck(this,SignUp);_this=_super.call(this,props);_this.state={stage:0,email:'',phone:'',genre:'',password:'',confirm:'',code:''};return _this;}_createClass(SignUp,[{key:\"onSubmitForm\",value:function(){var _onSubmitForm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var params,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;params={username:this.state.email.replace(/[@.]/g,'|'),password:this.state.password,attributes:{email:this.state.email,phone_number:this.state.phone,'custom:genre':this.state.genre},validationData:[]};_context.next=5;return Auth.signUp(params);case 5:data=_context.sent;console.log(data);this.setState({stage:1});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);if(_context.t0===\"No userPool\"){// User pool not defined in Amplify config file\nconsole.error(\"User Pool not defined\");alert(\"User Pool not defined. Amplify config must be updated with user pool config\");}else if(_context.t0.message===\"User already exists\"){// Setting state to allow user to proceed to enter verification code\nthis.setState({stage:1});}else{if(_context.t0.message.indexOf(\"phone number format\")>=0){_context.t0.message=\"Invalid phone number format. Must include country code. Example: +14252345678\";}alert(_context.t0.message);console.error(\"Exception from Auth.signUp: \",_context.t0);this.setState({stage:0,email:'',password:'',confirm:''});}case 13:case\"end\":return _context.stop();}}},_callee,this,[[1,10]]);}));function onSubmitForm(_x){return _onSubmitForm.apply(this,arguments);}return onSubmitForm;}()},{key:\"onSubmitVerification\",value:function(){var _onSubmitVerification=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;_context2.next=4;return Auth.confirmSignUp(this.state.email.replace(/[@.]/g,'|'),this.state.code);case 4:data=_context2.sent;console.log(data);// Go to the sign in page\nthis.props.history.replace('/signin');_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);alert(_context2.t0.message);console.error(\"Exception from Auth.confirmSignUp: \",_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,this,[[1,9]]);}));function onSubmitVerification(_x2){return _onSubmitVerification.apply(this,arguments);}return onSubmitVerification;}()},{key:\"onEmailChanged\",value:function onEmailChanged(e){this.setState({email:e.target.value.toLowerCase()});}},{key:\"onPhoneChanged\",value:function onPhoneChanged(e){this.setState({phone:e.target.value});}},{key:\"onGenreChanged\",value:function onGenreChanged(e){this.setState({genre:e.target.value.toLowerCase()});}},{key:\"onPasswordChanged\",value:function onPasswordChanged(e){this.setState({password:e.target.value});}},{key:\"onConfirmationChanged\",value:function onConfirmationChanged(e){this.setState({confirm:e.target.value});}},{key:\"onCodeChanged\",value:function onCodeChanged(e){this.setState({code:e.target.value});}},{key:\"isValidEmail\",value:function isValidEmail(email){var re=/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;return re.test(String(email).toLowerCase());}},{key:\"renderSignUp\",value:function renderSignUp(){var _this2=this;var isValidEmail=this.isValidEmail(this.state.email);var isValidPassword=this.state.password.length>1;var isValidGenre=this.state.genre.length>1;var isValidConfirmation=isValidPassword&&this.state.password===this.state.confirm;return/*#__PURE__*/React.createElement(\"div\",{className:\"app\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(DynamicImage,{src:\"logo.png\"})),/*#__PURE__*/React.createElement(\"section\",{className:\"form-wrap\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Register\"),/*#__PURE__*/React.createElement(\"form\",{id:\"registrationForm\",onSubmit:function onSubmit(e){return _this2.onSubmitForm(e);}},/*#__PURE__*/React.createElement(\"input\",{className:isValidEmail?'valid':'invalid',type:\"email\",placeholder:\"Email\",value:this.state.email,onChange:function onChange(e){return _this2.onEmailChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{className:\"valid\",type:\"phone\",placeholder:\"Phone\",value:this.state.phone,onChange:function onChange(e){return _this2.onPhoneChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{className:\"valid\",type:\"Genre\",placeholder:\"Genre\",value:this.state.genre,onChange:function onChange(e){return _this2.onGenreChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{className:isValidPassword?'valid':'invalid',type:\"password\",placeholder:\"Password\",value:this.state.password,onChange:function onChange(e){return _this2.onPasswordChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{className:isValidConfirmation?'valid':'invalid',type:\"password\",placeholder:\"Confirm Password\",value:this.state.confirm,onChange:function onChange(e){return _this2.onConfirmationChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{disabled:!(isValidEmail&&isValidPassword&&isValidConfirmation),type:\"submit\",value:\"Let's Ryde\"}))));}},{key:\"renderConfirm\",value:function renderConfirm(){var _this3=this;var isValidEmail=this.isValidEmail(this.state.email);var isValidCode=this.state.code.length===6;return/*#__PURE__*/React.createElement(\"div\",{className:\"app\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(DynamicImage,{src:\"logo.png\"})),/*#__PURE__*/React.createElement(\"section\",{className:\"form-wrap\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Verify Email\"),/*#__PURE__*/React.createElement(\"form\",{id:\"verifyForm\",onSubmit:function onSubmit(e){return _this3.onSubmitVerification(e);}},/*#__PURE__*/React.createElement(\"input\",{className:isValidEmail?'valid':'invalid',type:\"email\",placeholder:\"Email\",value:this.state.email}),/*#__PURE__*/React.createElement(\"input\",{className:isValidCode?'valid':'invalid',type:\"text\",placeholder:\"Verification Code\",value:this.state.code,onChange:function onChange(e){return _this3.onCodeChanged(e);}}),/*#__PURE__*/React.createElement(\"input\",{disabled:!(isValidCode&&isValidEmail),type:\"submit\",value:\"Verify\"}))));}},{key:\"render\",value:function render(){switch(this.state.stage){case 0:default:return this.renderSignUp();case 1:return this.renderConfirm();}}}]);return SignUp;}(React.Component);export default withRouter(SignUp);","map":{"version":3,"sources":["C:/Users/m_obr/OneDrive/Documents/GitHub/TEST/src/auth/SignUp.js"],"names":["React","Auth","DynamicImage","withRouter","SignUp","props","state","stage","email","phone","genre","password","confirm","code","e","preventDefault","params","username","replace","attributes","phone_number","validationData","signUp","data","console","log","setState","error","alert","message","indexOf","confirmSignUp","history","target","value","toLowerCase","re","test","String","isValidEmail","isValidPassword","length","isValidGenre","isValidConfirmation","onSubmitForm","onEmailChanged","onPhoneChanged","onGenreChanged","onPasswordChanged","onConfirmationChanged","isValidCode","onSubmitVerification","onCodeChanged","renderSignUp","renderConfirm","Component"],"mappings":"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","sourcesContent":["/*\r\n *   Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\r\n *  You may not use this file except in compliance with the License.\r\n *  A copy of the License is located at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  or in the \"license\" file accompanying this file. This file is distributed\r\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\r\n *  express or implied. See the License for the specific language governing\r\n *  permissions and limitations under the License.\r\n */\r\nimport React from 'react';\r\nimport { Auth } from 'aws-amplify';\r\nimport DynamicImage from '../components/DynamicImage';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport '../css/app.css';\r\n\r\n/**\r\n * Registration Page\r\n */\r\nclass SignUp extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      stage: 0,\r\n      email: '',\r\n      phone: '',\r\n      genre: '',\r\n      password: '',\r\n      confirm: '',\r\n      code: ''\r\n    };\r\n  }\r\n\r\n  async onSubmitForm(e) {\r\n    e.preventDefault();\r\n    try {\r\n        const params = {\r\n            username: this.state.email.replace(/[@.]/g, '|'),\r\n            password: this.state.password,\r\n            attributes: {\r\n                email: this.state.email,\r\n                phone_number: this.state.phone,\r\n                'custom:genre': this.state.genre\r\n            },\r\n            validationData: []\r\n        };\r\n        const data = await Auth.signUp(params);\r\n        console.log(data);\r\n        this.setState({ stage: 1 });\r\n    } catch (err) {\r\n    if (err === \"No userPool\") {\r\n        // User pool not defined in Amplify config file\r\n        console.error(\"User Pool not defined\");\r\n        alert(\"User Pool not defined. Amplify config must be updated with user pool config\");\r\n    } else if (err.message === \"User already exists\") {\r\n        // Setting state to allow user to proceed to enter verification code\r\n        this.setState({ stage: 1 });\r\n    } else {\r\n        if (err.message.indexOf(\"phone number format\") >= 0) {err.message = \"Invalid phone number format. Must include country code. Example: +14252345678\"}\r\n        alert(err.message);\r\n        console.error(\"Exception from Auth.signUp: \", err);\r\n        this.setState({ stage: 0, email: '', password: '', confirm: '' });\r\n    }\r\n    }\r\n}\r\n\r\nasync onSubmitVerification(e) {\r\n  e.preventDefault();\r\n  try {\r\n      const data = await Auth.confirmSignUp(\r\n          this.state.email.replace(/[@.]/g, '|'),\r\n          this.state.code\r\n      );\r\n      console.log(data);\r\n      // Go to the sign in page\r\n      this.props.history.replace('/signin');\r\n  } catch (err) {\r\n      alert(err.message);\r\n      console.error(\"Exception from Auth.confirmSignUp: \", err);\r\n  }\r\n}\r\n\r\n  onEmailChanged(e) {\r\n    this.setState({ email: e.target.value.toLowerCase() });\r\n  }\r\n\r\n  onPhoneChanged(e) {\r\n    this.setState({ phone: e.target.value });\r\n  }\r\n  \r\n  onGenreChanged(e) {\r\n    this.setState({ genre: e.target.value.toLowerCase() });\r\n  }\r\n\r\n  onPasswordChanged(e) {\r\n    this.setState({ password: e.target.value });\r\n  }\r\n\r\n  onConfirmationChanged(e) {\r\n    this.setState({ confirm: e.target.value });\r\n  }\r\n\r\n  onCodeChanged(e) {\r\n    this.setState({ code: e.target.value });\r\n  }\r\n\r\n  isValidEmail(email) {\r\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    return re.test(String(email).toLowerCase());\r\n  }\r\n\r\n  renderSignUp() {\r\n    const isValidEmail = this.isValidEmail(this.state.email);\r\n    const isValidPassword = this.state.password.length > 1;\r\n    const isValidGenre = this.state.genre.length > 1;\r\n    const isValidConfirmation = isValidPassword && this.state.password === this.state.confirm;\r\n\r\n    return (\r\n      <div className=\"app\">\r\n        <header>\r\n          <DynamicImage src=\"logo.png\"/>\r\n        </header>\r\n        <section className=\"form-wrap\">\r\n          <h1>Register</h1>\r\n          <form id=\"registrationForm\" onSubmit={(e) => this.onSubmitForm(e)}>\r\n            <input className={isValidEmail?'valid':'invalid'} type=\"email\" placeholder=\"Email\" value={this.state.email} onChange={(e) => this.onEmailChanged(e)}/>\r\n            <input className='valid' type=\"phone\" placeholder=\"Phone\" value={this.state.phone} onChange={(e) => this.onPhoneChanged(e)}/>\r\n            <input className='valid' type=\"Genre\" placeholder=\"Genre\" value={this.state.genre} onChange={(e) => this.onGenreChanged(e)}/>\r\n            <input className={isValidPassword?'valid':'invalid'} type=\"password\" placeholder=\"Password\" value={this.state.password} onChange={(e) => this.onPasswordChanged(e)}/>\r\n            <input className={isValidConfirmation?'valid':'invalid'} type=\"password\" placeholder=\"Confirm Password\" value={this.state.confirm} onChange={(e) => this.onConfirmationChanged(e)}/>\r\n            <input disabled={!(isValidEmail && isValidPassword && isValidConfirmation)} type=\"submit\" value=\"Let's Ryde\"/>\r\n          </form>\r\n        </section>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderConfirm() {\r\n    const isValidEmail = this.isValidEmail(this.state.email);\r\n    const isValidCode = this.state.code.length === 6;\r\n\r\n    return (\r\n      <div className=\"app\">\r\n        <header>\r\n          <DynamicImage src=\"logo.png\"/>\r\n        </header>\r\n        <section className=\"form-wrap\">\r\n          <h1>Verify Email</h1>\r\n          <form id=\"verifyForm\" onSubmit={(e) => this.onSubmitVerification(e)}>\r\n            <input className={isValidEmail?'valid':'invalid'} type=\"email\" placeholder=\"Email\" value={this.state.email}/>\r\n            <input className={isValidCode?'valid':'invalid'} type=\"text\" placeholder=\"Verification Code\" value={this.state.code} onChange={(e) => this.onCodeChanged(e)}/>\r\n            <input disabled={!(isValidCode&&isValidEmail)} type=\"submit\" value=\"Verify\"/>\r\n          </form>\r\n        </section>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    switch (this.state.stage) {\r\n      case 0:\r\n      default:\r\n        return this.renderSignUp();\r\n      case 1:\r\n        return this.renderConfirm();\r\n    }\r\n  }\r\n}\r\n\r\nexport default withRouter(SignUp);\r\n"]},"metadata":{},"sourceType":"module"}